<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>1.defineProperty</title>
</head>
<body>
  
</body>

<script>
 // ES5 && ES6
 // 创建对象 1.字面量 2.构造函数方式 3. Object.create() 4.Object.defineProperty 5.通过类实例化对象

 // 1.字面量
//  let obj = {
//    name: '张三'
//  }
//  console.log(obj)

// 2.构造函数
// new: 执行函数；创建一个空对象；将空对象和this绑定；如无返回值，隐式返回this
// function Person(name) {
//   this.name = name
// }
// let zhangsan = new Person('张三')
// console.log(zhangsan)

// 3.Object.create()
// 创造公共空间：属性方法挂载在原型上
// let obj = Object.create({
//   name: '张三'
// })
// console.log(obj.name)

// 4、Object.defineProperty()--单个属性
// 无法删除属性: 由于configurable默认为false
// 无法遍历 Object.keys Object.value也不行：由于enumerable默认为false
// 手动设置configurable和enumerable为true即可
// let value = ''
// let obj = Object.defineProperty({}, 'name', {
//   configurable: true,
//   enumerable: true,
//   get(){
//     console.log('get'+value)
//     return value
//   },
//   set(newValue) {
//     value = newValue
//     console.log('set'+value)
//   }
// })
// obj.name='张三'
// console.log(obj.name)
// for(let i in obj) { // 设置enumerable: true后可遍历
//   console.log(123, i)
// }
// delete obj.name // 设置configurable: true后可删除属性
// console.log(obj)

// let data = {
//   name: '张三',
//   age: 20
// }
// console.log(data)
// let value = data.name
// Object.defineProperty(data, 'name', {
//   configurable: true,
//   enumerable: true,
//   get() {
//     console.log('get')
//     return value
//   },
//   set(newValue) {
//     console.log('set')
//     value = newValue
//   }
// })
// let age = data.age
// Object.defineProperty(data, 'age', {
//   configurable: true,
//   enumerable: true,
//   get() {
//     console.log('get')
//     return age
//   },
//   set(newValue) {
//     console.log('set')
//     age = newValue
//   }
// })

// defineProperty的作用：数据观察，数据劫持
let data = {
  name: '张三',
  age: 20,
  sex: '男'
}
function Observer(data) {
  let keys = Object.keys(data)
  keys.forEach(key => {
    let value = data[key]
    Object.defineProperty(data, key, {
      configurable: true,
      enumerable: true,
      get() {
        console.log('get')
        return value
      },
      set(newValue) {
        console.log('set')
        value = newValue
      }
    })
  })
}
Observer(data)
console.log(data)
</script>
</html>