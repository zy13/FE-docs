<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="/public/assets/css/login.css">
</head>
<body>
  <div class="wrapper">
    <form>
      <input class="username" type="text" placeholder="用户名" required>
      <input class="password" type="password" placeholder="密码" required autocomplete='password'>
    </form>
    <button>登  录</button>
  </div>
</body>
<script>
  const loginBtn = document.querySelector('button')
  const input = document.querySelectorAll('input')

  loginBtn.onclick = async () => {
    let params = {
      username: input[0].value,
      password: input[1].value
    }

    // 账密非空
    if(!params.username || !params.password) {
      return alert('用户名或者密码不能为空')
    }

    // 发送请求，获取token
    let req = new Request('/login',  {
      method: 'post',
      body: JSON.stringify(params)
    })
    let res = await fetch(req)
    let data = await res.json()
    
    if(data.code==400) {
      return alert(data.msg)
    }
    // 本地存储token
    localStorage.setItem('token', data.token)
    window.location.href = '/public/user.html'
  }
</script>
</html>